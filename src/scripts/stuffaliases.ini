[aliases]
n0=;##############################################
n1=;################### Клавиши ##################
n2=f1 help $1-
n3=F5  if ($editbox($active)) editbox -an $st.shuf($editbox($active))
n4=F6  if ($editbox($active)) editbox -an /mcom amsg $editbox($active)
n5=F7 if ($editbox($active)) editbox -an /me [ $iif($chr(32) $+ №ник isin $editbox($active),$replace($editbox($active),$chr(32) $+ №ник,$chr(32) $+ $$1),$editbox($active)) ]
n6=F8  if ($editbox($active)) editbox -an /mcom ame $editbox($active)
n7=
n8=sF5  if ($editbox($active)) editbox -an $st.color($editbox($active))
n9=sF6  if ($editbox($active)) editbox -an /mcom amsg [ [ $editbox($active) ] ]
n10=sF7 if ($editbox($active)) editbox -an /me [ [ $editbox($active) ] ]
n11=sF8  if ($editbox($active)) editbox -an /mcom ame [ [ $editbox($active) ] ]
n12=
n13=cF5 if ($editbox($active)) editbox -an $st.spaces($editbox($active))
n14=cF9 editbox -a $trans.en.ru($editbox($active))
n15=cF10 editbox -a $trans.ru.en($editbox($active))
n16=
n17=j join #$1 $2-
n18=† describe $active поставил $+ $sex(,а,о,и) на $snicks †
n19=
n20=;##############################################
n21=;################# переводчики ################
n22=trans.en.ru return $replacecs($1-,.,ю,$chr(44),б,q,й,w,ц,e,у,r,к,t,е,y,н,u,г,i,ш,o,щ,p,з,[,х,],ъ,a,ф,s,ы,d,в,f,а,g,п,h,р,j,о,k,л,l,д,;,ж,',э,z,я,x,ч,c,с,v,м,b,и,n,т,m,ь,.,ю,Q,Й,W,Ц,E,У,R,К,T,Е,Y,Н,U,Г,I,Ш,O,Щ,P,З,[,Х,A,Ф,S,Ы,D,В,F,А,G,П,H,Р,J,О,K,Л,L,Д,:,Ж,",Э,Z,Я,X,Ч,C,С,V,М,B,И,N,Т,<,Б,>,Ю,?,$chr(44),&,?,^,:,/,.,`,ё,$,;,№,$chr(35))
n23=trans.ru.en return $replacecs($1-,ю,.,б,$chr(44),й,q,ц,w,у,e,к,r,е,t,н,y,г,u,ш,i,щ,o,з,p,х,[,ъ,],ф,a,ы,s,в,d,а,f,п,g,р,h,о,j,л,k,д,l,ж,;,э,',я,z,ч,x,с,c,м,v,и,b,т,n,ь,m,б,.,Й,Q,Ц,W,У,E,К,R,Е,T,Н,Y,Г,U,Ш,I,Щ,O,З,P,Х,[,Ъ,],Ф,A,Ы,S,В,D,А,F,П,G,Р,H,О,J,Л,K,Д,L,Ж,:,Э,",Я,Z,Ч,X,С,C,М,V,И,B,Т,N,Ь,M,Б,<,Ю,>,$chr(44),?,?,&,:,^,.,/,ё,`,;,$,№,$chr(35),Ё,~)
n24=
n25=;##############################################
n26=;################# стиллизаторы ###############
n27=st.color {
n28=  ;раскраска случайными цветами
n29=  var %len = 0 , %str , %nik , %col
n30=  set %str $null
n31=  set %nik  $replace($1-, $chr(32),$chr(1)) 
n32=  :cvet
n33=  set %col $rand(3,13)
n34=  if ( %col isnum 1-9 ) set %col 0 $+ %col
n35=  set %str %str $+  $+ %col $+ $left( %nik , 1) 
n36=  set %nik $right( %nik , -1 )
n37=  set %len $calc( %len + 1 )
n38=  if ( %len >= $len($1-) ) { return  $replace(%str $+ ,$chr(1), $chr(32))  | halt } 
n39=  else {  goto cvet }
n40=}
n41=
n42=st.shuf {
n43=  ;перемешивание строки
n44=  var %str, %nik, %num | set %str $null | set %nik $replace($1,$chr(32),$chr(1))
n45=  :shuf
n46=  set %num $rand(1,$len(%nik)) | set %str %str $+ $mid(%nik,%num,1) | set %nik $left(%nik,$calc(%num -1)) $+ $right(%nik,$calc($len(%nik) - %num))
n47=  if ($len(%nik)) goto shuf
n48=  return  $replace(%str,$chr(1), $chr(32),$chr(2),$chr(44))
n49=}
n50=
n51=st.spaces {
n52=  ;после каждого символа идет один пробел
n53=  var %i = 1, %str
n54=  set %old $1-
n55=  :loop
n56=  set %str %str $left(%old,1)
n57=  set %old $right(%old,-1)
n58=  inc %i 1
n59=  if (%i < $calc(2 + $len($1-))) goto loop
n60=  return %str
n61=}
n62=
n63=st.twocolors {
n64=  ;строка красится в два цвета: первым цветом первая буква каждого слова, остальная часть слова вторым цветом
n65=  var %i = 1, %str
n66=  while (%i <= $len($3)) {
n67=    set %str %str  $+ $1 $+ $left($gettok($3,%i,32),1) $+ $iif($right($gettok($3,%i,32),-1), $+ $2 $+ $ifmatch)
n68=    inc %i
n69=  }
n70=  return %str
n71=}
n72=
n73=st.revert {
n74=  ;строка задом наперед
n75=  var %i = 0, %str, %str2
n76=  set %str $replace($1-,$chr(32),$chr(1))
n77=  :loop
n78=  set %str2 %str2 $+ $right(%str,1)
n79=  set %str $left(%str,-1)
n80=  if ($len(%str)) goto loop
n81=  return $replace(%str2,$chr(1),$chr(32))
n82=}
n83=
n84=;##############################################
n85=;################## дополнения ################
n86=nick.insert {
n87=  if (($changet($chan,colors) == 1) || ((($changet($chan,colors) == 2) || ($changet($chan,colors) == $null)) && (c !isincs $chan($active).mode))) var %color = $true
n88=  var %nick = [ [ $replace($1-,$chr(32),$chr(44) $+ $chr(32),_,$chr(32)) ] ], %mes = $editbox($chan)
n89=  if (!%nick) %nick = $1-
n90=  var %tmp = $readini(strings/passes.ini,$1,names)
n91=  if ($rand(0,$numtok(%tmp,1)) != 0) { set %nick $gettok(%tmp,$ifmatch,1) }
n92=  var %text = [ [ %str.nickins ] ]
n93=
n94=  if ($editbox($chan) != $null)  {
n95=    if (%prefs.nickinsert.type == 1) editbox -na $iif(%color,%text,$strip(%text))
n96=    if (%prefs.nickinsert.type == 2) editbox -na $iif(%color,%text,$strip(%text))
n97=    if (%prefs.nickinsert.type == 3) query $1-
n98=    if (%prefs.nickinsert.type == 4) editbox -a $iif(%color,%text,$strip(%text))
n99=  }
n100=  else { 
n101=    if (%prefs.nickinsert.type == 1) query $1-
n102=    if (%prefs.nickinsert.type == 2) editbox -a $iif(%color,%text,$strip(%text))
n103=    if (%prefs.nickinsert.type == 3) editbox -a $iif(%color,%text,$strip(%text))
n104=    if (%prefs.nickinsert.type == 4) query $1-
n105=  }
n106=}
n107=
n108=nill { }
n109=
n110=runt { if (!$exists($1)) { write $1 } | run $1 }
n111=google  { run http://www.google.ru/search?q= $+ $replace($1-,$chr(32),+) }
n112=g google $1-
n113=d google define: $+ $1-
n114=
n115============================================
n116=netsetup {
n117=  var %pref = $readini(strings/networks.ini,$network,$1)
n118=  var %info, %def
n119=  if ($2 == $null) {
n120=    if ($istok(chanserv.call nickserv.call memoserv.call,$1,32)) { %info = Команда вызова сервиса | %def = msg $gettok($1,1,46) }
n121=    if ($istok(fastghost,$1,32)) { %info = Автоматическая смена ника при команде ns ghost $crlf $+ Может принимать значения $true и $false | %def = $true }
n122=    if ($istok(nickidentstring,$1,32)) { %info = Строка, которой сервис ников запрашивает ввод пароля | %def = This nickname is registered and protected. If it is your }
n123=    if ($istok(nickregisterstring,$1,32)) { %info = Строка, которой сервис ников предлагает регистрацию | %def = This nick is not registered, if you intend to use it in the future }
n124=    if (!%info) %info = Измените поле $1 | if (!%def) %def = $null
n125=    var %tmp = $input(%info,eyq,Настройка сети $network,$iif(%pref,%pref,%def))
n126=    if (%tmp) writeini strings/networks.ini $network $1 %tmp
n127=    return
n128=  }
n129=  writeini strings/networks.ini $network $1 $2-
n130=}
n131=
n132=netget {
n133=  var %tmp = $readini(strings/networks.ini,$network,$1)
n134=  if (%tmp) return %tmp
n135=  if ($1 == MemoServ.call) return .msg memoserv 
n136=  if ($1 == NickServ.call) return .msg nickserv 
n137=  if ($1 == ChanServ.call) return .msg chanserv 
n138=}
n139=
n140=nickset {
n141=  var %pref = $readini(strings/passes.ini,$network,$1)
n142=  var %info, %ishide, %def
n143=  if ($3 == $null) {
n144=    if ($istok(password,$2,32)) { %info = Пароль от $1 в сети $network | %def = $nickget($1,password) | %ishide = $false }
n145=    if (!%info) %info = Поле $2 от $1 в сети $network | if (!%def) %def = $null
n146=    var %tmp = $input(%info,eyq $+ $iif(%ishide,p),Настройка ника $1 в сети $network,$iif(%pref,%pref,%def))
n147=    if (%tmp) writeini strings/passes.ini $1 [ $2 ] $+ + $+ [ $network ] %tmp
n148=    return
n149=  }
n150=  writeini strings/passes.ini $1 [ $2 ] $+ + $+ [ $network ] $3-
n151=}
n152=
n153=nickget {
n154=  return $readini(strings/passes.ini,$1,[ $2 ] $+ + $+ [ $network ])
n155=}
n156=
n157=userset {
n158=  var %pref = $readini(strings/setup.ini,user,$1)
n159=  var %info, %def
n160=  if ($1 == timestamp) { .timestamp -f $2- | writeini strings/setup.ini user $1 $2- | return }
n161=  if ($1 == nick) { nick $2- | writeini strings/setup.ini user $1 $2- | return }
n162=  if ($1 == anick) { .anick $2- | writeini strings/setup.ini user $1 $2- | return }
n163=  if ($1 == sex) { set %sex $iif($2,$2,1) | writeini strings/setup.ini user $1 $2 | return }
n164=  if ($2 == $null) {
n165=    if ($istok(pass.email,$1,32)) { %info = Почта, используемая для писем паролей | %def = nomail }
n166=    if (!%info) %info = Измените поле $1 | if (!%def) %def = $null
n167=    var %tmp = $input(%info,eyq,Настройка сети $network,$iif(%pref,%pref,%def))
n168=    if (%tmp) { writeini strings/user.ini user $1 %tmp | set $chr(37) $+ [ $1 ] %tmp }
n169=    return
n170=  }
n171=  writeini strings/setup.ini user $1 $2- | set $chr(37) $+ [ $1 ] %tmp
n172=}
n173=
n174=userget {
n175=  return $readini(strings/setup.ini,user,$1)
n176=}
n177=
n178=stdget {
n179=  if ($1- == str.away.nochange) return  $ $+ + % $+ colors.info $ $+ + Причина ухода совпадает с текущей
n180=  if ($1- == str.away.msg) return 10уш $ $+ + $ $+ sex(ел,ла,ло,ли) $ $+ + 3. Причина:10 $ $+ 1-
n181=  if ($1- == str.away.return) return 10вернул $ $+ + $ $+ sex(ся,ась,ось,ись) $ $+ + . 3Уходил $ $+ + $ $+ sex(,а,о,и) $+ 10 $ $+ duration($awaytime,3) 3назад по причине:10 $ $+ awaymsg
n182=  if ($1- == str.away.change) return 10уходил $ $+ + $ $+ sex(,а,о,и) $ $+ + 3 $ $+ duration($awaytime,3) 10назад по причине:3 $ $+ awaymsg $ $+ + 10. Теперь уш $ $+ + $ $+ sex(ел,ла,ло,ли) по причине:3 $ $+ 1-
n183=  if ($1- == str.away.repeat) return 10не здесь. 3Уш $ $+ + $ $+ sex(ел,ла,ло,ли) $ $+ + 10 $ $+ duration($awaytime,3) 3назад по причине:10 $ $+ awaymsg
n184=  if ($1- == nums.away.rep.mins) return 40
n185=  if ($1- == nums.menulist.len) return 15
n186=  if ($1- == str.status.click) return Сервер $ $+ + % $+ colors.server $ $+ server подключен к сети $ $+ + % $+ colors.server $ $+ network
n187=  if ($1- == str.servecho) return $ $+ network $ $+ + 9: Сервис $ $+ 1 $ $+ + 9| $ $+ 2-
n188=  if ($1- == str.finger.ans) return Пальцем не тыкать!
n189=  if ($1- == str.quit.mes) return $ $+ iif($network == gamenavigator,http://magic.gamenavigator.ru,Magic Script % $+ str.version от % $+ str.vdate $ $+ + )
n190=  if ($1- == str.nickins) return 4 $ $+ + % $+ nick $ $+ + 3, % $+ mes
n191=  if ($1- == user.timestamp) return $chr(91) HH:nn:ss $chr(93)
n192=}
n193=
n194=chanset {
n195=  var %info, %ishide, %def, %pref
n196=  if ($3 == $null) {
n197=    if ($istok(password,$2,32)) { %info = Пароль от $1 в сети $network | %def = $changet($1,$2) | %ishide = $false }
n198=    if (!%info) %info = Поле $2 от $1 в сети $network | if (!%def) %def = $null
n199=    var %tmp = $input(%info,eyq $+ $iif(%ishide,p),Настройка канала  $1 в сети $network,$iif(%pref,%pref,%def))
n200=    if (%tmp) writeini strings/chans.ini $1 [ $2 ] $+ + $+ [ $network ] %tmp
n201=    return
n202=  }
n203=  writeini strings/chans.ini $1 [ $2 ] $+ + $+ [ $network ] $3-
n204=}
n205=
n206=changet {
n207=  return $readini(strings/chans.ini,$1,[ $2 ] $+ + $+ [ $network ])
n208=}
n209=
n210=if3 {
n211=  ;var n1 n2 n3 ans1 ans2 ans3 ans4
n212=  if ($1 == $2) { return $5 | halt }
n213=  if ($1 == $3) { return $6 | halt }
n214=  if ($1 == $4) { return $8 | halt }
n215=  return $7
n216=}
n217=
n218=sex {
n219=  return $if3(%sex,m,f,n,$1,$2,$3,$4)
n220=}
n221=;===========================================
n222=forumfight {
n223=  if (!$exists(forumfight\) mkdir forumfight
n224=  unset %forum.*
n225=  inc %forums.num
n226=  var %filename, %i, %err, %j, %lines, %turn, %targ, %att, %block, %phr
n227=  var %filepath forumfight\
n228=  var %filename result
n229=  set %filename %filepath $+ %filename $+ . $+ %forums.num $+ .txt
n230=  set %i 1
n231=  while (%i <= $0) { echo -a file [ $ [ $+ [ %i ] ] ] $+ .txt | if (!$exists(%filepath $+ [ $ [ $+ [ %i ] ] ] $+ .txt)) set %err %err Нету файла [ $ [ $+ [ %i ] ] ] $+ .txt | inc %i }
n232=  if (%err) { echo -a %err | halt }
n233=  write %filename Битва $0 человек. Участники : $1-
n234=  set %i 1
n235=  while (%i <= $0) { if (%i == 1) set %lines $lines(%filepath $+ [ $ [ $+ [ %i ] ] ] $+ .txt) | else if (%lines != $lines(%filepath $+ [ $ [ $+ [ %i ] ] ] $+ .txt)) set %err Различное количество строк в файлах. | inc %i }
n236=  if (%err) { echo -a %err | halt }
n237=  write %filename %lines ходов
n238=  set %j 1 
n239=  write %filename -------------
n240=  while (%j <= %lines) {
n241=    write %filename Раунд %j
n242=    set %i 1
n243=    while (%i <= $0) {
n244=      set %turn $read(%filepath $+ [ $ [ $+ [ %i ] ] ] $+ .txt, %j)
n245=      set %targ $gettok(%turn,1,32) | set %att $gettok(%turn,2,32) | set %phr $gettok(%turn,4-,32)
n246=      if ($gettok($read(%filepath $+ %targ $+ .txt,%j),3,32) == %att) { 
n247=        write %filename [ $ [ $+ [ %i ] ] ] $+ : %targ %att $gettok(%turn,3,32) $+ . -- не смог нанести %targ удар в %att $iif(%phr, $+ . < $+ %phr $+ >)
n248=        inc %forum.succ_block [ $+ [ %targ ] ]
n249=      }
n250=      else {
n251=        write %filename [ $ [ $+ [ %i ] ] ] $+ : %targ %att $gettok(%turn,3,32) $+ . -- смог нанести %targ удар в %att $iif(%phr, $+ . < $+ %phr $+ >)
n252=        inc %forum.succ_att [ $+ [ $ [ $+ [ %i ] ] ] ]
n253=      }
n254=      inc %forum.incoming [ $+ [ %targ ] ]
n255=      inc %i
n256=    }
n257=    inc %j
n258=    write %filename -------------  
n259=    write %filename -------------  
n260=  }
n261=  set %i 1
n262=  write %filename Количество удачных атак:
n263=  while (%i <= $0) {
n264=    write %filename [ $ [ $+ [ %i ] ] ] - $iif(%forum.succ_att [ $+ [ $ [ $+ [ %i ] ] ] ],$ifmatch,0) попаданий
n265=    inc %i
n266=  }
n267=  set %i 1
n268=  write %filename Количество входящих:
n269=  while (%i <= $0) {
n270=    set %block $calc(%forum.incoming [ $+ [ $ [ $+ [ %i ] ] ] ] - %forum.succ_block [ $+ [ $ [ $+ [ %i ] ] ] ] )
n271=    write %filename [ $ [ $+ [ %i ] ] ] - пропустил $calc(%forum.incoming [ $+ [ $ [ $+ [ %i ] ] ] ] - %forum.succ_block [ $+ [ $ [ $+ [ %i ] ] ] ] ) из %forum.incoming [ $+ [ $ [ $+ [ %i ] ] ] ] ударов (блок $round($calc(%forum.succ_block [ $+ [ $ [ $+ [ %i ] ] ] ] / %forum.incoming [ $+ [ $ [ $+ [ %i ] ] ] ] * 100),0 ) $+ $chr(37) $+ $chr(41) $+ , заблокировал $iif(%forum.succ_block [ $+ [ $ [ $+ [ %i ] ] ] ],$ifmatch,0)
n272=    inc %i
n273=  }
n274=  %i = 1
n275=  while (%i <= $0) { rename %filepath $+ [ $ [ $+ [ %i ] ] ] $+ .txt %filepath $+ %forums.num $+ . $+ [ $ [ $+ [ %i ] ] ] $+ .txt | inc %i }
n276=  run %filename
n277=}
n278=
n279=color.hextodec {
n280=  var %r, %g, %b
n281=  set %r $left($1,2)
n282=  set %g $mid($1,3,2)
n283=  set %b $right($1,2)
n284=  %r = $calc($replace($left(%r,1),a,10,b,11,c,12,d,13,e,14,f,15) * 16 + $replace($right(%r,1),a,10,b,11,c,12,d,13,e,14,f,15))
n285=  %g = $calc($replace($left(%g,1),a,10,b,11,c,12,d,13,e,14,f,15) * 16 + $replace($right(%g,1),a,10,b,11,c,12,d,13,e,14,f,15))
n286=  %b = $calc($replace($left(%b,1),a,10,b,11,c,12,d,13,e,14,f,15) * 16 + $replace($right(%b,1),a,10,b,11,c,12,d,13,e,14,f,15))
n287=  return %r %g %b
n288=}
n289=color.dectohex {
n290=  var %r, %g, %b
n291=  set %r $left($1,3)
n292=  set %g $mid($1,4,3)
n293=  set %b $right($1,3)
n294=  %r = $replace($int($calc(%r / 16)),10,a,11,b,12,c,13,d,14,e,15,f) $+ $replace($calc(%r - $int($calc(%r / 16)) * 16),10,a,11,b,12,c,13,d,14,e,15,f)
n295=  %g = $replace($int($calc(%g / 16)),10,a,11,b,12,c,13,d,14,e,15,f) $+ $replace($calc(%g - $int($calc(%g / 16)) * 16),10,a,11,b,12,c,13,d,14,e,15,f)
n296=  %b = $replace($int($calc(%b / 16)),10,a,11,b,12,c,13,d,14,e,15,f) $+ $replace($calc(%b - $int($calc(%b / 16)) * 16),10,a,11,b,12,c,13,d,14,e,15,f)
n297=  return %r %g %b
n298=}
n299=
n300=dectohex { }
