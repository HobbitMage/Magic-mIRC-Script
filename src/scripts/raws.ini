[script]
n0=;errors
n1=on *:input:*:{ oninput $1- }
n2=raw *:*:{ if (!$istok(%prefs.ignoreraws,$numeric,32)) { onraw $numeric $1- } }
n3=on *:notice:*:*:onnotice $nick $1-
n4=ctcp ^*:*:*:onctcp $nick $1-
n5=on *:nick:onnick $nick $newnick
n6=on *:join:#:onjoin $nick $chan
n7=on *:part:#:onpart $nick $chan $1-
n8=on *:quit:onquit $nick $1-
n9=
n10=alias onraw {
n11=  if ($1 == 301) { 
n12=    if ([ %isaway_ [ $+ [ $3 ] $+ _ $+ [ $server ] ] ]) { halt }
n13=    set -u [ $+ [ %nums.away.show.delay ] ] %isaway_ [ $+ [ $3 ] $+ _ $+ [ $server ] ] $true
n14=  }
n15=  ;if ($1 == 353) { group.color.find $4- }
n16=  return
n17=}
n18=
n19=alias onnotice {
n20=  if ($istok(nickserv chanserv memoserv,$1,32)) {
n21=    servecho $replace($left($1,4),nick,ников,chan,каналов,memo,собщений) $2-
n22=  }
n23=  if (($1 == nickserv) && ($2- == $netget(nickidentstring))) {
n24=    if ($nickget($me,password)) $netget(nickserv.call) identify $nickget($me,password)
n25=    else echo %colors.info -at Вы выбрали занятый ник  $+ $me $+ , если он ваш, идентифицируйтесь!
n26=  }
n27=}
n28=
n29=alias onctcp {
n30=  if ($2 == version) { ctcpreply $1 $2 $st.color(Magic script) %str.version | return }
n31=  if ($2 == finger) { ctcpreply $1 $2 $ctcp.finger.ans | haltdef | return }
n32=}
n33=
n34=alias servecho { 
n35=  if (%prefs.serv.window) {
n36=    if (!$window(@Сервисы))   window -ek0mxzn @Сервисы // $+ $netget(nickserv.call) 
n37=    echo 3 -t @Сервисы [ [ %str.servecho ] ] 
n38=  }
n39=  return
n40=}
n41=
n42=alias group.color {
n43=  ;$1 = nick $2 = color
n44=  var %i = 1, %num = $chan(0)
n45=  while (%i <= %num) {
n46=    if ($1 ison $chan(%i)) cline $iif($2 isnum 0-15,-l $2,-lr) $chan(%i) $1
n47=    inc %i 
n48=  }
n49=}
n50=alias group.color.find {
n51=  var %num = $0
n52=  var %i = 2, %nick, %group
n53=  while (%i <= %num) {
n54=    %nick = $remove($ [ $+ [ %i ] ],+,@,.,%)
n55=    %group = $nickget(%nick,group)
n56=    if (%group == Друзья) cline -l %logview.n.friend $1 %nick
n57=    if (%group == Враги) cline -l %logview.n.enemy $1 %nick
n58=    inc %i
n59=  }
n60=}
n61=
n62=alias onnick {
n63=}
n64=
n65=alias onjoin {
n66=  if ($1 == $me) return
n67=}
n68=
n69=alias onpart {
n70=  if (($window($1)) && ($3 == +q)) echo %logview.info -t $1  $+ %logview.hl $+ $1 вышел из сети.
n71=}
n72=alias onquit {
n73=  if ($window($1)) echo %logview.info -t $1  $+ %logview.hl $+ $1 вышел из сети.
n74=}
n75=
n76=alias oninput {
n77=}
