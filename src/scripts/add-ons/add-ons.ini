[script]
n0=;on *:join:#qwerty:{ if ($istok(%akickhosts,$address($nick,0),32)) { kick $chan $nick | halt } }
n1=;alias  addakick { set %akickhosts $addtok(%akickhosts,$1,32) }
n2=
n3=menu menubar {
n4=  Дополнения
n5=  .Перевод цветов:if ($dialog(Colors)) dialog -v Colors | else dialog -m Colors hexdec
n6=  .Калькулятор выпадения лута::if ($dialog(randomloot )) dialog -v randomloot | dialog -m randomloot randomloot
n7=}
n8=
n9=dialog hexdec {
n10=  title "Калькулятор"
n11=  size -1 -1 65 80
n12=  option dbu
n13=  edit "", 1, 3 13 50 10
n14=  edit "", 2, 3 33 50 10
n15=  edit "", 3, 3 52 50 10
n16=  text "Результат", 4, 3 44 29 8
n17=  button "Пересчитать", 5, 3 64 37 12
n18=  button "OK", 6, 40 64 15 12, default ok
n19=  radio "Десятичное", 7, 0 4 50 10, group
n20=  radio "Шестнадцатиричное", 8, 0 23 65 10
n21=}
n22=
n23=on *:dialog:Colors:*:*:{
n24=  if ($devent == init) { did -c Colors 7  }
n25=  if ($devent == edit) {
n26=    if ($did == 1) { did -c Colors 7 | did -u Colors 8 }
n27=    if ($did == 2) { did -c Colors 8 | did -u Colors 7 }
n28=  }
n29=  if ($devent == sclick) {
n30=    if ($did == 5) { 
n31=      if ($did(7).state) { did -r Colors 3 | did -a Colors 3 $color.dectohex($did(1)) }
n32=      if ($did(8).state) { did -r Colors 3 | did -a Colors 3 $color.hextodec($did(2)) }
n33=    }
n34=  }
n35=}
n36=
n37=dialog randomloot {
n38=  title "Случайный цикл"
n39=  size -1 -1 134 52
n40=  option dbu
n41=  edit "", 1, 82 2 50 10
n42=  text "Шанс (до 0,001%)", 2, 2 3 50 8
n43=  text "Количество (целое, больше 0)", 3, 1 15 81 8
n44=  edit "", 4, 82 14 50 10
n45=  edit "", 5, 1 26 132 10, disable result
n46=  button "Пересчитать", 6, 2 37 40 12
n47=  button "Закрыть", 7, 95 37 37 12, ok
n48=}
n49=
n50=on *:dialog:randomloot:*:*: {
n51=
n52=  if ($devent == sclick) {
n53=    if ($did == 6) {   if (($did(1) >= 0.001) && ($did(4) >= 1)) {  
n54=        did -r randomloot 5 | did -a randomloot 5 $add.randomloot($did(1),$did(4)) 
n55=        echo %logview.info -ag Результаты рандома: вероятность  $+ %logview.hl $+ $did(1) $+ , количество подсчетов  $+ %logview.hl $+ $did(4)
n56=        echo %logview.info -ag Результаты рандома:  $+ %logview.hl $+ $did(5)
n57=      }
n58=    }
n59=    if ($did == 7) { 
n60=    }
n61=  }
n62=}
n63=
n64=alias add.randomloot {
n65=  var %i = 1, %n = 1, %res
n66=  while (%n <= $2) {
n67=    while ($rand(0,100000) >= $calc($1 * 1000)) {
n68=      inc %i
n69=    }
n70=    %res = %res %i
n71=    %i = 1
n72=    inc %n
n73=  }
n74=  return %res
n75=}
